<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rezeptverwaltung</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        const API_BASE = '/api';

        // Hilfsfunktion: Bild oder Emoji rendern
        function RezeptBild({ bild, className = '' }) {
            if (bild && /\.(png|jpe?g|gif|webp)$/i.test(bild)) {
                return <img src={`/images/${bild}`} alt="" className={`object-cover rounded ${className}`} style={{width:64,height:64}} />;
            }
            return <span className={`flex items-center justify-center ${className}`} style={{fontSize:40,width:64,height:64}}>{bild || 'ğŸ½'}</span>;
        }

        function App() {
            // â”€â”€ Hauptdaten â”€â”€
            const [rezepteDb, setRezepteDb]       = useState([]);
            const [toBeCooked, setToBeCooked]     = useState([]);
            const [toBeBought, setToBeBought]     = useState([]);

            // â”€â”€ UI â”€â”€
            const [activeTab, setActiveTab]       = useState('rezepte');
            const [loading, setLoading]           = useState(true);

            // â”€â”€ Modals â”€â”€
            const [showAddRecipe, setShowAddRecipe]           = useState(false);
            const [showAddIngredient, setShowAddIngredient]   = useState(false);
            const [showRecipeWarning, setShowRecipeWarning]   = useState(null);
            const [editingIndex, setEditingIndex]             = useState(null);
            const [editValue, setEditValue]                   = useState('');

            // â”€â”€ Suche â”€â”€
            const [searchMode, setSearchMode]     = useState('name');
            const [searchQuery, setSearchQuery]   = useState('');

            // â”€â”€ Entfernte Zutaten (rote Kacheln) â”€â”€
            // Nur die Zutaten die vom Server "entfernt" markiert sind UND nicht mehr in toBeBought existieren
            const [alreadyBought, setAlreadyBought] = useState([]);

            // â”€â”€ Checkboxen Mehrfachauswahl â”€â”€
            const [selectedIndices, setSelectedIndices]       = useState(new Set());

            // â”€â”€ Neue Zutat â”€â”€
            const [newIngredient, setNewIngredient] = useState('');

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // Daten laden
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            useEffect(() => { loadAllData(); }, []);

            async function loadAllData() {
                setLoading(true);
                try {
                    const [rRes, cRes, bRes] = await Promise.all([
                        fetch(`${API_BASE}/rezepte`),
                        fetch(`${API_BASE}/to-be-cooked`),
                        fetch(`${API_BASE}/to-be-bought`)
                    ]);
                    if (!rRes.ok || !cRes.ok || !bRes.ok) throw new Error('Server-Antwort nicht OK');
                    const rezepte = await rRes.json();
                    const cooked  = await cRes.json();
                    const bought  = await bRes.json();
                    setRezepteDb(Array.isArray(rezepte) ? rezepte : []);
                    setToBeCooked(Array.isArray(cooked) ? cooked  : []);
                    setToBeBought(Array.isArray(bought) ? bought  : []);
                } catch (e) {
                    console.error(e);
                    alert('Fehler beim Laden der Daten.\nIst der Server gestartet? (node server.js)');
                } finally { setLoading(false); }
            }

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // Rezepte-Aktionen
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            async function addRecipe(rezept) {
                try {
                    const res = await fetch(`${API_BASE}/to-be-cooked`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(rezept)
                    });
                    if (res.ok) { await loadAllData(); setShowAddRecipe(false); setSearchQuery(''); setSearchMode('name'); }
                } catch (e) { console.error(e); }
            }

            // LÃ¶sche ein einzelnes Rezept; Server gibt alreadyBoughtIngredients zurÃ¼ck
            async function deleteRecipe(rezeptId) {
                try {
                    const res = await fetch(`${API_BASE}/to-be-cooked/${rezeptId}`, { method: 'DELETE' });
                    if (res.ok) {
                        const data = await res.json();
                        console.log("[deleteRecipe] Response:", data);
                        await loadAllData();
                        if (data.alreadyBoughtIngredients && data.alreadyBoughtIngredients.length > 0) {
                            console.log("[deleteRecipe] Setting alreadyBought:", data.alreadyBoughtIngredients);
                            setAlreadyBought(prev => [...prev, ...data.alreadyBoughtIngredients]);
                            setActiveTab('zutaten');
                        }
                    }
                } catch (e) { console.error(e); }
            }

            // LÃ¶sche alle Rezepte die an einer Zutat hÃ¤ngen (vom !-Button)
            async function deleteRecipesFromWarning() {
                if (!showRecipeWarning) return;
                const ids = showRecipeWarning.zutat.rezeptIds || [];
                let alleBought = [];
                for (const id of ids) {
                    try {
                        const res = await fetch(`${API_BASE}/to-be-cooked/${id}`, { method: 'DELETE' });
                        if (res.ok) {
                            const data = await res.json();
                            console.log("[deleteRecipesFromWarning] Recipe", id, "response:", data);
                            if (data.alreadyBoughtIngredients) alleBought.push(...data.alreadyBoughtIngredients);
                        }
                    } catch (e) { console.error(e); }
                }
                setShowRecipeWarning(null);
                await loadAllData();
                if (alleBought.length > 0) {
                    console.log("[deleteRecipesFromWarning] Setting alreadyBought with", alleBought.length, "items:", alleBought);
                    setAlreadyBought(prev => [...prev, ...alleBought]);
                }
            }

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // Zutaten-Aktionen
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            async function addIngredient() {
                if (!newIngredient.trim()) return;
                try {
                    const res = await fetch(`${API_BASE}/to-be-bought`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ name: newIngredient.trim(), rezeptId: null, rezeptName: null })
                    });
                    if (res.ok) { await loadAllData(); setNewIngredient(''); setShowAddIngredient(false); }
                } catch (e) { console.error(e); }
            }

            async function deleteIngredient(index) {
                try {
                    const res = await fetch(`${API_BASE}/to-be-bought/${index}`, { method: 'DELETE' });
                    if (res.ok) { await loadAllData(); setSelectedIndices(new Set()); }
                } catch (e) { console.error(e); }
            }

            // Mehrere markierte Zutaten gleichzeitig lÃ¶schen
            // LÃ¶sche von hinten nach vorne damit die Indizes nicht verschieben
            async function deleteSelectedIngredients() {
                const sorted = [...selectedIndices].sort((a, b) => b - a);
                for (const idx of sorted) {
                    try {
                        await fetch(`${API_BASE}/to-be-bought/${idx}`, { method: 'DELETE' });
                    } catch (e) { console.error(e); }
                }
                setSelectedIndices(new Set());
                await loadAllData();
            }

            async function saveEditedIngredient() {
                if (editingIndex === null || !editValue.trim()) return;
                try {
                    const res = await fetch(`${API_BASE}/to-be-bought/${editingIndex}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ newName: editValue.trim() })
                    });
                    if (res.ok) { await loadAllData(); setEditingIndex(null); setEditValue(''); }
                } catch (e) { console.error(e); }
            }

            // Checkbox-Hilfsfunktionen
            function toggleSelect(index) {
                setSelectedIndices(prev => {
                    const next = new Set(prev);
                    next.has(index) ? next.delete(index) : next.add(index);
                    return next;
                });
            }
            function toggleAll() {
                if (selectedIndices.size === toBeBought.length) {
                    setSelectedIndices(new Set());
                } else {
                    setSelectedIndices(new Set(toBeBought.map((_, i) => i)));
                }
            }

            // Rote Kachel wegrÃ¤umen
            function dismissRemoved(idx) {
                setAlreadyBought(prev => prev.filter((_, i) => i !== idx));
            }
            function dismissAllRemoved() {
                setAlreadyBought([]);
            }

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // Rezept-Suche / Filter
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            const verfuegbareRezepte = rezepteDb.filter(r => !toBeCooked.some(tc => tc.id === r.id));

            const filteredRezepte = (() => {
                if (searchMode === 'random') {
                    if (verfuegbareRezepte.length === 0) return [];
                    return [verfuegbareRezepte[Math.floor(Math.random() * verfuegbareRezepte.length)]];
                }
                const q = searchQuery.trim().toLowerCase();
                if (!q) return verfuegbareRezepte;
                if (searchMode === 'name')       return verfuegbareRezepte.filter(r => r.name.toLowerCase().includes(q));
                if (searchMode === 'ingredient') return verfuegbareRezepte.filter(r => r.zutaten.some(z => z.toLowerCase().includes(q)));
                return verfuegbareRezepte;
            })();

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // RENDER
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            if (loading) {
                return <div className="flex items-center justify-center h-screen"><p className="text-xl text-gray-500">Lade Daten...</p></div>;
            }

            return (
                <div className="max-w-4xl mx-auto p-4">
                    <h1 className="text-3xl font-bold text-gray-800 mb-6">Rezeptverwaltung</h1>

                    {/* â”€â”€ Tabs â”€â”€ */}
                    <div className="flex border-b border-gray-300 mb-6">
                        {['rezepte','zutaten'].map(tab => (
                            <button key={tab} onClick={() => setActiveTab(tab)}
                                className={`px-6 py-3 font-semibold transition-colors ${
                                    activeTab === tab ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-500 hover:text-gray-700'
                                }`}
                            >{tab === 'rezepte' ? 'Rezepte' : 'Zutaten'}</button>
                        ))}
                    </div>

                    {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        REZEPTE-TAB
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                    {activeTab === 'rezepte' && (
                        <div>
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-semibold text-gray-700">Zu kochende Rezepte</h2>
                                <button onClick={() => setShowAddRecipe(true)}
                                    className="bg-blue-600 text-white w-10 h-10 rounded-full text-2xl hover:bg-blue-700 flex items-center justify-center">+</button>
                            </div>

                            {toBeCooked.length === 0
                                ? <p className="text-gray-400 text-center py-10">Keine Rezepte geplant</p>
                                : <div className="space-y-3">
                                    {toBeCooked.map(rezept => (
                                        <div key={rezept.id} className="bg-white p-4 rounded-lg shadow flex items-center justify-between">
                                            <div className="flex items-center space-x-4">
                                                <RezeptBild bild={rezept.bild} />
                                                <div>
                                                    <h3 className="font-semibold text-lg">{rezept.name}</h3>
                                                    <p className="text-sm text-gray-400">{rezept.zutaten.length} Zutaten</p>
                                                </div>
                                            </div>
                                            <button onClick={() => deleteRecipe(rezept.id)}
                                                className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">LÃ¶schen</button>
                                        </div>
                                    ))}
                                </div>
                            }
                        </div>
                    )}

                    {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ZUTATEN-TAB
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                    {activeTab === 'zutaten' && (
                        <div>
                            {/* Header-Zeile: Titel + Buttons */}
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-semibold text-gray-700">Einkaufsliste</h2>
                                <div className="flex items-center space-x-2">
                                    {/* Sammel-LÃ¶schen-Button â€“ nur sichtbar wenn etwas markiert */}
                                    {selectedIndices.size > 0 && (
                                        <button onClick={deleteSelectedIngredients}
                                            className="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors text-sm font-semibold">
                                            {selectedIndices.size} LÃ¶schen
                                        </button>
                                    )}
                                    <button onClick={() => setShowAddIngredient(true)}
                                        className="bg-blue-600 text-white w-10 h-10 rounded-full text-2xl hover:bg-blue-700 flex items-center justify-center">+</button>
                                </div>
                            </div>

                            {/* â”€â”€ Rote Kacheln: Zutaten die durch RezeptlÃ¶schen Ã¼berflÃ¼ssig sind â”€â”€ */}
                            {alreadyBought.length > 0 && (
                                <div className="mb-4">
                                    <div className="flex justify-between items-center mb-2">
                                        <p className="text-sm text-red-600 font-semibold">Bereits besorgt, aber nicht mehr benÃ¶tigt:</p>
                                        <button onClick={dismissAllRemoved}
                                            className="text-xs text-red-500 hover:text-red-700 underline">Alle wegrÃ¤umen</button>
                                    </div>
                                    <div className="space-y-2">
                                        {alreadyBought.map((zutat, idx) => (
                                            <div key={idx} className="bg-red-100 border border-red-300 p-3 rounded-lg flex items-center justify-between">
                                                <span className="text-red-700 font-semibold">âˆ’ {zutat.name}</span>
                                                <button onClick={() => dismissRemoved(idx)}
                                                    className="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-colors text-sm">LÃ¶schen</button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* â”€â”€ Normale Zutatenliste mit Checkboxen â”€â”€ */}
                            {toBeBought.length === 0 && alreadyBought.length === 0
                                ? <p className="text-gray-400 text-center py-10">Keine Zutaten auf der Liste</p>
                                : toBeBought.length > 0 && (
                                    <div>
                                        {/* Alles-Ankreuzen Checkbox */}
                                        <div className="flex items-center mb-2 px-1">
                                            <label className="flex items-center space-x-2 cursor-pointer select-none">
                                                <input type="checkbox"
                                                    checked={selectedIndices.size === toBeBought.length && toBeBought.length > 0}
                                                    onChange={toggleAll}
                                                    className="w-4 h-4 accent-blue-600 cursor-pointer" />
                                                <span className="text-sm text-gray-500">Alle auswÃ¤hlen</span>
                                            </label>
                                        </div>

                                        <div className="space-y-2">
                                            {toBeBought.map((zutat, index) => (
                                                <div key={index} className={`rounded-lg shadow p-3 transition-colors ${selectedIndices.has(index) ? 'bg-blue-50 border border-blue-300' : 'bg-white'}`}>
                                                    {/* Bearbeiten-Modus */}
                                                    {editingIndex === index ? (
                                                        <div className="flex items-center space-x-2">
                                                            <input type="text" value={editValue}
                                                                onChange={e => setEditValue(e.target.value)}
                                                                onKeyDown={e => { if (e.key === 'Enter') saveEditedIngredient(); if (e.key === 'Escape') { setEditingIndex(null); setEditValue(''); } }}
                                                                className="flex-1 border border-gray-300 rounded px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                                                autoFocus />
                                                            <button onClick={saveEditedIngredient}
                                                                className="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition-colors text-sm">âœ“</button>
                                                            <button onClick={() => { setEditingIndex(null); setEditValue(''); }}
                                                                className="bg-gray-300 text-gray-600 px-3 py-1 rounded hover:bg-gray-400 transition-colors text-sm">âœ•</button>
                                                        </div>
                                                    ) : (
                                                        <div className="flex items-center">
                                                            {/* Checkbox */}
                                                            <input type="checkbox"
                                                                checked={selectedIndices.has(index)}
                                                                onChange={() => toggleSelect(index)}
                                                                className="w-4 h-4 accent-blue-600 cursor-pointer mr-3 flex-shrink-0" />

                                                            {/* Name + Rezept-Tags */}
                                                            <div className="flex items-center flex-wrap gap-2 flex-1 min-w-0 mr-2">
                                                                <span className="text-gray-800 font-medium">{zutat.name}</span>
                                                                {zutat.rezeptNames && zutat.rezeptNames.map((rn, i) => (
                                                                    <span key={i} className="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded">{rn}</span>
                                                                ))}
                                                            </div>

                                                            {/* Buttons */}
                                                            <div className="flex items-center space-x-1.5 flex-shrink-0">
                                                                {/* Bearbeiten */}
                                                                <button onClick={() => { setEditingIndex(index); setEditValue(zutat.name); }}
                                                                    className="bg-gray-200 text-gray-600 w-8 h-8 rounded hover:bg-gray-300 transition-colors flex items-center justify-center"
                                                                    title="Menge bearbeiten">âœ</button>
                                                                {/* !-Button */}
                                                                {zutat.rezeptIds && zutat.rezeptIds.length > 0 && (
                                                                    <button onClick={() => setShowRecipeWarning({ zutat, index })}
                                                                        className="bg-yellow-400 text-yellow-900 w-8 h-8 rounded hover:bg-yellow-500 transition-colors font-bold flex items-center justify-center"
                                                                        title="ZugehÃ¶rige Rezepte anzeigen">!</button>
                                                                )}
                                                                {/* Einzeln-LÃ¶schen */}
                                                                <button onClick={() => deleteIngredient(index)}
                                                                    className="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-colors text-sm">LÃ¶schen</button>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )
                            }
                        </div>
                    )}

                    {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        MODAL: Rezept hinzufÃ¼gen
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                    {showAddRecipe && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-lg p-6 max-w-2xl w-full" style={{maxHeight:'80vh',overflowY:'auto'}}>
                                <h3 className="text-xl font-semibold mb-4">Rezept hinzufÃ¼gen</h3>

                                {/* Suchmodus-Tabs */}
                                <div className="flex space-x-2 mb-4">
                                    {[
                                        { key: 'name',       label: 'ğŸ” Nach Name' },
                                        { key: 'random',     label: 'ğŸ² ZufÃ¤llig' },
                                        { key: 'ingredient', label: 'ğŸ¥• Nach Zutat' }
                                    ].map(m => (
                                        <button key={m.key}
                                            onClick={() => { setSearchMode(m.key); setSearchQuery(''); }}
                                            className={`flex-1 py-2 px-3 rounded transition-colors text-sm font-medium ${
                                                searchMode === m.key ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                            }`}
                                        >{m.label}</button>
                                    ))}
                                </div>

                                {/* Suchfeld */}
                                {(searchMode === 'name' || searchMode === 'ingredient') && (
                                    <input type="text" value={searchQuery} onChange={e => setSearchQuery(e.target.value)}
                                        placeholder={searchMode === 'name' ? 'Rezeptname...' : 'Zutat...'}
                                        className="w-full border border-gray-300 rounded px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        autoFocus />
                                )}

                                {/* Ergebnisliste */}
                                {verfuegbareRezepte.length === 0
                                    ? <p className="text-gray-400 text-center py-4">Alle Rezepte wurden bereits hinzugefÃ¼gt</p>
                                    : filteredRezepte.length === 0
                                        ? <p className="text-gray-400 text-center py-4">Keine Rezepte gefunden</p>
                                        : <div className="space-y-2 mb-3" style={{maxHeight:'300px',overflowY:'auto'}}>
                                            {filteredRezepte.map(r => (
                                                <button key={r.id} onClick={() => addRecipe(r)}
                                                    className="w-full text-left p-3 rounded border border-gray-200 hover:bg-gray-50 flex items-start space-x-3 transition-colors">
                                                    <RezeptBild bild={r.bild} className="flex-shrink-0" />
                                                    <div className="min-w-0">
                                                        <div className="font-semibold text-gray-800">{r.name}</div>
                                                        <div className="text-sm text-gray-500 mt-0.5">
                                                            {r.zutaten.length} Zutaten
                                                            {searchMode === 'ingredient' && searchQuery.trim() && (
                                                                <span className="ml-2 text-blue-600">
                                                                    â€¢ {r.zutaten.filter(z => z.toLowerCase().includes(searchQuery.trim().toLowerCase())).join(', ')}
                                                                </span>
                                                            )}
                                                        </div>
                                                    </div>
                                                </button>
                                            ))}
                                        </div>
                                }

                                <button onClick={() => { setShowAddRecipe(false); setSearchQuery(''); setSearchMode('name'); }}
                                    className="w-full mt-2 bg-gray-200 text-gray-600 py-2 rounded hover:bg-gray-300 transition-colors">Abbrechen</button>
                            </div>
                        </div>
                    )}

                    {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        MODAL: Zutat hinzufÃ¼gen
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                    {showAddIngredient && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-xl font-semibold mb-4">Zutat hinzufÃ¼gen</h3>
                                <input type="text" value={newIngredient}
                                    onChange={e => setNewIngredient(e.target.value)}
                                    onKeyDown={e => { if (e.key === 'Enter') addIngredient(); }}
                                    placeholder="z. B. 200g Kartoffeln"
                                    className="w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    autoFocus />
                                <div className="flex space-x-2">
                                    <button onClick={addIngredient}
                                        className="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition-colors">HinzufÃ¼gen</button>
                                    <button onClick={() => { setShowAddIngredient(false); setNewIngredient(''); }}
                                        className="flex-1 bg-gray-200 text-gray-600 py-2 rounded hover:bg-gray-300 transition-colors">Abbrechen</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        MODAL: !-Button â†’ Rezepte anzeigen / lÃ¶schen
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                    {showRecipeWarning && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-xl font-semibold mb-2">ZugehÃ¶rige Rezepte</h3>
                                <p className="text-sm text-gray-500 mb-3">
                                    Die Zutat <strong className="text-gray-800">{showRecipeWarning.zutat.name}</strong> wird in folgenden Rezepten benÃ¶tigt:
                                </p>
                                <ul className="mb-4 space-y-1">
                                    {(showRecipeWarning.zutat.rezeptNames || []).map((name, i) => (
                                        <li key={i} className="flex items-center space-x-2">
                                            <span className="inline-block w-2 h-2 rounded-full bg-blue-500"></span>
                                            <span className="text-gray-700 font-medium">{name}</span>
                                        </li>
                                    ))}
                                </ul>
                                <p className="text-sm text-gray-500 mb-4">
                                    MÃ¶chten Sie alle diese Rezepte und ihre zugehÃ¶rigen Zutaten lÃ¶schen?
                                </p>
                                <div className="flex flex-col space-y-2">
                                    <button onClick={deleteRecipesFromWarning}
                                        className="w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition-colors font-medium">
                                        Alle Rezepte lÃ¶schen
                                    </button>
                                    <button onClick={() => setShowRecipeWarning(null)}
                                        className="w-full bg-gray-200 text-gray-600 py-2 rounded hover:bg-gray-300 transition-colors">Abbrechen</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
